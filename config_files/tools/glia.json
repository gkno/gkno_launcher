{
  "id" : "glia",
  "configuration type" : "tool",
  "description" : "Perform read-by-read local realignment using a graph representation of the reference genome and variants.",
  "categories" : ["BAM-processing", "Aligners", "Variant-graph", "Marthlab-software"],
  "tools" : ["glia"],
  "path" : "glia",
  "executable" : "glia",
  "arguments" : {
    "Inputs" : [
      {
        "description" : "The input bam file.",
        "long form argument" : "--in",
        "short form argument" : "-i",
        "command line argument" : "--in",
        "required" : true,
        "if input is stream" : {
          "default" : {
            "argument" : "omit",
            "value" : ""
          }
        },
        "data type" : "string",
        "extensions" : ["bam"]
      },
      {
        "description" : "The reference sequence for alignment.",
        "long form argument" : "--fasta-reference",
        "short form argument" : "-r",
        "command line argument" : "--fasta-reference",
        "required" : true,
        "data type" : "string",
        "extensions" : ["fa", "fasta"]
      },
      {
        "description" : "The genome DAG, BGZIP'ed (.vcf.gz) and tabix-indexed (.tbi).",
        "long form argument" : "--vcf",
        "short form argument" : "-v",
        "command line argument" : "--vcf-file",
        "required" : true,
        "data type" : "string",
        "extensions" : ["vcf.gz"]
      },
      {
        "description" : "The genome DAG index.",
        "long form argument" : "--index",
        "short form argument" : "-x",
        "command line argument" : "--vcf-index",
        "required" : true,
        "data type" : "string",
        "extensions" : ["tbi"],
        "hide argument in help" : true,
        "modify argument" : "omit",
        "modify value" : "omit",
        "construct filename" : {
          "method": "from tool argument",
          "use argument" : "--vcf",
          "modify extension" : "append"
        }
      }
    ],
  
    "Outputs" : [
      {
        "description" : "The output realigned BAM file.",
        "long form argument" : "--out",
        "short form argument" : "-o",
        "command line argument" : "-out",
        "required" : true,
        "data type" : "string",
        "extensions" : ["bam"],
        "modify argument" : "stdout",
        "if output to stream" : {
          "default" : {
            "argument" : "omit",
            "value" : "omit"
          }
        },
        "construct filename" : {
          "method": "from tool argument",
          "use argument" : "--in",
          "modify extension" : "replace",
          "modify text" : [
            {
              "add text" : ["_glia"]
            }
          ]
        }
      }
    ],
  
    "Smith-Waterman parameters" : [
      {
        "description" : "The alignment match score (default 10).",
        "long form argument" : "--match",
        "short form argument" : "-m",
        "command line argument" : "--match",
        "data type" : "integer"
      },
      {
        "description" : "The alignment mismatch score (default -10).",
        "long form argument" : "--mismatch",
        "short form argument" : "-ms",
        "command line argument" : "--mismatch",
        "data type" : "integer"
      },
      {
        "description" : "Gap open penalty (default 3).",
        "long form argument" : "--gap-open",
        "short form argument" : "-go",
        "command line argument" : "--gap-open",
        "data type" : "integer"
      },
      {
        "description" : "Gap extension penalty (default 1).",
        "long form argument" : "--gap-extend",
        "short form argument" : "-ge",
        "command line argument" : "--gap-extend",
        "data type" : "integer"
      }
    ],

    "Single-read alignment parameters" : [
      {
        "description" : "Target genomic region for alignment, e.g. chr2:1-20",
        "long form argument" : "--region",
        "short form argument" : "-rg",
        "command line argument" : "--target",
        "data type" : "string"
      },
      {
        "description" : "Write DAG generated from variants to stdout.",
        "long form argument" : "--display-dag",
        "short form argument" : "-dd",
        "command line argument" : "--display-dag",
        "data type" : "flag"
      },
      {
        "description" : "Write alignment matrix results to stdout.",
        "long form argument" : "--display-backtrace",
        "short form argument" : "-dt",
        "command line argument" : "--display-backtrace",
        "data type" : "flag"
      },
      {
        "description" : "Same as --display-backtrace but also for nodes which are not traced.",
        "long form argument" : "--display-all-nodes",
        "short form argument" : "-dn",
        "command line argument" : "--display-all-nodes",
        "data type" : "flag"
      },
      {
        "description" : "Enable debugging output.",
        "long form argument" : "--debug-glia",
        "short form argument" : "-dg",
        "command line argument" : "--display-all-nodes",
        "data type" : "flag"
      },
      {
        "description" : "Report the reverse complement if it provides a better alignment.",
        "long form argument" : "--reverse-complement",
        "short form argument" : "-rc",
        "command line argument" : "--reverse-complement",
        "data type" : "flag"
      }
    ],

    "local realignment parameters" : [
      {
        "description" : "The input VCF is normalized so that overlapping variants are represented in a single record (as by vcflib/bin/vcfcreatemulti). Do not decompose variant representation in VCF file to construct graph.",
        "long form argument" : "--flat-input-vcf",
        "short form argument" : "-f",
        "command line argument" : "--flat-input-vcf",
        "data type" : "flag"
      },
      {
        "description" : "Number of bp of window to assemble from VCF for realignment.",
        "long form argument" : "--realignment-window",
        "short form argument" : "-rw",
        "command line argument" : "--realignment-window",
        "data type" : "integer"
      },
      {
        "description" : "Do not attempt streaming sort of alignments.  This can save memory in high coverage areas, but will require sort of BAM file before it can be used for variant calling.",
        "long form argument" : "--unsorted-output",
        "short form argument" : "-u",
        "command line argument" : "--unsorted-output",
        "data type" : "flag"
      },
      {
        "description" : "If sum of qualities of soft clipped bases is >= N, realign (default ~inf).",
        "long form argument" : "--soft-clip-qsum-threshold",
        "short form argument" : "-s",
        "command line argument" : "--soft-clip-qsum-threshold",
        "data type" : "integer"
      },
      {
        "description" : "If sum of qualities of mismatched bases is >= N, realign (default ~inf).",
        "long form argument" : "--mismatch-qsum-threshold",
        "short form argument" : "-mqt",
        "command line argument" : "--mismatch-qsum-threshold",
        "data type" : "integer"
      },
      {
        "description" : "If the count of gaps is >= N, realign (default: ~inf).",
        "long form argument" : "--gap-count-threshold",
        "short form argument" : "-gc",
        "command line argument" : "--gap-count-threshold",
        "data type" : "integer"
      },
      {
        "description" : "If the total length of gaps is >= N, realign (default: ~inf).",
        "long form argument" : "--gap-length-threshold",
        "short form argument" : "-gl",
        "command line argument" : "--gap-length-threshold",
        "data type" : "integer"
      },
      {
        "description" : "Accept realignment if qsum of softclips is < N.",
        "long form argument" : "--soft-clip-qsum-max",
        "short form argument" : "-sc",
        "command line argument" : "--soft-clip-qsum-max",
        "data type" : "integer"
      },
      {
        "description" : "Accept realignment if qsom of mismatches is < N.",
        "long form argument" : "--mismatch-qsum-max",
        "short form argument" : "-mq",
        "command line argument" : "--mismatch-qsum-max",
        "data type" : "integer"
      },
      {
        "description" : "Accept realignment if number of gaps is < N.",
        "long form argument" : "--gap-count-max",
        "short form argument" : "-gcm",
        "command line argument" : "--gap-count-max",
        "data type" : "integer"
      },
      {
        "description" : "Use this many bp of dummy sequence when flattening large insertions into reference coordinates (default: 2)",
        "long form argument" : "--flatten-rank",
        "short form argument" : "-fr",
        "command line argument" : "--flatten-rank",
        "data type" : "integer"
      }
    ],

    "hidden options" : [
      {
        "description" : "Realign the BAM stream on stdin to the VCF file, adjusting position and flattening alignments back into the reference space where realignment to the graph provides better quality.",
        "long form argument" : "--realign-bam",
        "short form argument" : "-rb",
        "command line argument" : "--realign-bam",
        "required" : true,
        "data type" : "flag"
      }
    ]
  },

  "argument order" : [
    "--in",
    "--realign-bam",
    "--fasta-reference",
    "--vcf",
    "--index",
    "--match",
    "--mismatch",
    "--gap-open",
    "--gap-extend",
    "--region",
    "--display-dag",
    "--display-backtrace",
    "--display-all-nodes",
    "--debug-glia",
    "--reverse-complement",
    "--flat-input-vcf",
    "--realignment-window",
    "--unsorted-output",
    "--soft-clip-qsum-threshold",
    "--mismatch-qsum-threshold",
    "--gap-count-threshold",
    "--gap-length-threshold",
    "--soft-clip-qsum-max",
    "--mismatch-qsum-max",
    "--gap-count-max",
    "--flatten-rank",
    "--out"
  ],

  "parameter sets" : [
    {
      "id" : "default",
      "description" : "Default parameter set requires the users input for all files.",
      "data" : [
        {
          "id" : "realign",
          "argument" : "--realign-bam",
          "values" : ["set"]
        },
        {
          "id" : "reverse complement",
          "argument" : "--reverse-complement",
          "values" : ["set"]
        },
        {
          "id" : "unsorted output",
          "argument" : "--unsorted-output",
          "values" : ["set"]
        },
        {
          "id" : "window",
          "argument" : "--realignment-window",
          "values" : [1500]
        },
        {
          "id" : "soft-clip",
          "argument" : "--soft-clip-qsum-threshold",
          "values" : [200]
        },
        {
          "id" : "mismatch",
          "argument" : "--mismatch-qsum-threshold",
          "values" : [200]
        },
        {
          "id" : "gap",
          "argument" : "--gap-count-max",
          "values" : [4]
        }
      ]
    },

    {
      "id" : "human",
      "description" : "Parameter set for the human genome.",
      "data" : [
        {
          "id" : "ref",
          "argument" : "--fasta-reference",
          "values" : ["$(RESOURCES)/homo_sapiens/current/human_reference_v37_decoys.fa"]
        }
      ]
    },

    {
      "id" : "test",
      "description" : "Parameter set for use with the test-harness.",
      "data" : [
        {
          "id" : "bam",
          "argument" : "--in",
          "values" : ["$(RESOURCES)/tutorial/current/mutated_genome.bam"]
        },
        {
          "id" : "vcf",
          "argument" : "--vcf",
          "values" : ["$(RESOURCES)/tutorial/current/chr20_fragment.dbSNP.snps.sites.vcf.gz"]
        },
        {
          "id" : "fasta",
          "argument" : "--fasta-reference",
          "values" : ["$(RESOURCES)/tutorial/current/chr20_fragment_moblist.fa"]
        },
        {
          "id" : "region",
          "argument" : "--region",
          "values" : ["20"]
        },
        {
          "id" : "unsorted",
          "argument" : "--unsorted-output",
          "values" : ["set"]
        }
      ]
    }
  ]
}
