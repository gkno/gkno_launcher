{
  "description" : "Build Mosaik reference files and align fastq files using Mosaik (additional processing steps included).",
  "help group" : "MEI pipelines",

  "tasks" : {
    "build-tangram-reference" : {
      "tool" : "tangram-index"
    },
    "scan-bam-files" : {
      "tool" : "tangram-scan"
    },
    "detect-mei" : {
      "tool" : "tangram-detect"
    }
  },

  "nodes" : [
    {
      "ID" : "reference fasta",
      "description" : "The reference fasta file.",
      "long form argument" : "--fasta-reference",
      "short form argument" : "-f",
      "tasks" : {
        "build-tangram-reference" : "--fasta-reference"
      }
    },
    {
      "ID" : "moblist reference fasta",
      "description" : "The mobile element reference fasta file.",
      "long form argument" : "--mobile-element-fasta",
      "short form argument" : "-mob",
      "tasks" : {
        "build-tangram-reference" : "--special-reference"
      }
    },
    {
      "ID" : "tangram reference",
      "description" : "The reference file created by Tangram index.",
      "long form argument" : "--tangram-reference",
      "short form argument" : "-tr",
      "tasks" : {
        "build-tangram-reference" : "--tangram-reference",
        "detect-mei" : "--tangram-reference"
      }
    },
    {
      "ID" : "processors",
      "description" : "The number of processors to use.",
      "long form argument" : "--processors",
      "short form argument" : "-p",
      "tasks" : {
        "detect-mei" : "--processors"
      }
    },
    {
      "ID" : "bam list",
      "description" : "List of bam files.",
      "long form argument" : "--bam-list",
      "short form argument" : "-bl",
      "required" : true,
      "tasks" : {
        "scan-bam-files" : "--in-list",
        "detect-mei" : "--in-list"
      }
    },
    {
      "ID" : "tangram directory",
      "description" : "The output directory for Tangram files.",
      "long form argument" : "--tangram-directory",
      "short form argument" : "-td",
      "required" : true,
      "tasks" : {
        "scan-bam-files" : "--output-directory"
      }
    },
    {
      "ID" : "fragments",
      "description" : "The minimum number of normal fragments in a library.",
      "long form argument" : "--minimum-fragments",
      "short form argument" : "-mfr",
      "tasks" : {
        "scan-bam-files" : "--minimum-fragments"
      }
    },
    {
      "ID" : "library file",
      "description" : "Library information file (generated by tangram-scan).",
      "long form argument" : "--library-file",
      "short form argument" : "-l",
      "tasks" : {
        "scan-bam-files" : "--library-file",
        "detect-mei" : "--library-file"
      }
    },
    {
      "ID" : "histogram file",
      "description" : "Fragment length distribution information file (generated by tangram-scan).",
      "long form argument" : "--histogram-file",
      "short form argument" : "-ht",
      "tasks" : {
        "scan-bam-files" : "--histogram-file",
        "detect-mei" : "--histogram-file"
      }
    },
    {
      "ID" : "region",
      "description" : "Genomic region.",
      "long form argument" : "--region",
      "short form argument" : "-rg",
      "tasks" : {
        "detect-mei" : "--region"
      }
    },
    {
      "ID" : "vcf",
      "description" : "Output MEIs.",
      "long form argument" : "--vcf",
      "short form argument" : "-v",
      "tasks" : {
        "detect-mei" : "--vcf"
      }
    }
  ],

  "parameter sets" : [
    {
      "ID" : "default",
      "description" : "Default parameter set requires user to input all input filenames.",
      "nodes" : [
        {
          "ID" : "tangram reference",
          "argument" : "--tangram-reference",
          "values" : ["$(PWD)/tangram_reference.dat"]
        },
        {
          "ID" : "tangram directoey",
          "argument" : "--tangram-directory",
          "values" : ["$(PWD)/tangram_files"]
        }
      ]
    },

    {
      "ID" : "test",
      "description" : "Test parameter set for the test harness.",
      "nodes" : [
        {
          "ID" : "fasta reference",
          "argument" : "--fasta-reference",
          "values" : ["$(RESOURCES)/tutorial/current/chr20_fragment.fa"]
        },
        {
          "ID" : "moblist",
          "argument" : "--mobile-element-fasta",
          "values" : ["$(RESOURCES)/tutorial/current/mobile_element_sequences.fa"]
        },
        {
          "ID" : "bam list",
          "argument" : "--bam-list",
          "values" : ["$(RESOURCES)/tutorial/current/bam_list.txt"]
        },
        {
          "ID" : "vcf",
          "argument" : "--vcf",
          "values" : ["tangram_mei_calls.vcf"]
        },
        {
          "ID" : "region",
          "argument" : "--region",
          "values" : [20]
        },
        {
          "ID" : "fragments",
          "argument" : "--minimum-fragments",
          "values" : [0]
        }
      ]
    }
  ]
}
